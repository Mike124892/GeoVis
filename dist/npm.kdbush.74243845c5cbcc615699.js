"use strict";(self.webpackChunkgeovis=self.webpackChunkgeovis||[]).push([[747],{8141:(t,r,s)=>{s.d(r,{A:()=>i});const n=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class i{static from(t){if(!(t instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[r,s]=new Uint8Array(t,0,2);if(219!==r)throw new Error("Data does not appear to be in a KDBush format.");const e=s>>4;if(1!==e)throw new Error(`Got v${e} data when expected v1.`);const o=n[15&s];if(!o)throw new Error("Unrecognized array type.");const[h]=new Uint16Array(t,2,1),[a]=new Uint32Array(t,4,1);return new i(a,h,o,t)}constructor(t,r=64,s=Float64Array,i){if(isNaN(t)||t<0)throw new Error(`Unpexpected numItems value: ${t}.`);this.numItems=+t,this.nodeSize=Math.min(Math.max(+r,2),65535),this.ArrayType=s,this.IndexArrayType=t<65536?Uint16Array:Uint32Array;const e=n.indexOf(this.ArrayType),o=2*t*this.ArrayType.BYTES_PER_ELEMENT,h=t*this.IndexArrayType.BYTES_PER_ELEMENT,a=(8-h%8)%8;if(e<0)throw new Error(`Unexpected typed array class: ${s}.`);i&&i instanceof ArrayBuffer?(this.data=i,this.ids=new this.IndexArrayType(this.data,8,t),this.coords=new this.ArrayType(this.data,8+h+a,2*t),this._pos=2*t,this._finished=!0):(this.data=new ArrayBuffer(8+o+h+a),this.ids=new this.IndexArrayType(this.data,8,t),this.coords=new this.ArrayType(this.data,8+h+a,2*t),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+e]),new Uint16Array(this.data,2,1)[0]=r,new Uint32Array(this.data,4,1)[0]=t)}add(t,r){const s=this._pos>>1;return this.ids[s]=s,this.coords[this._pos++]=t,this.coords[this._pos++]=r,s}finish(){const t=this._pos>>1;if(t!==this.numItems)throw new Error(`Added ${t} items when expected ${this.numItems}.`);return e(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(t,r,s,n){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:i,coords:e,nodeSize:o}=this,h=[0,i.length-1,0],a=[];for(;h.length;){const d=h.pop()||0,p=h.pop()||0,c=h.pop()||0;if(p-c<=o){for(let o=c;o<=p;o++){const h=e[2*o],d=e[2*o+1];h>=t&&h<=s&&d>=r&&d<=n&&a.push(i[o])}continue}const f=c+p>>1,u=e[2*f],y=e[2*f+1];u>=t&&u<=s&&y>=r&&y<=n&&a.push(i[f]),(0===d?t<=u:r<=y)&&(h.push(c),h.push(f-1),h.push(1-d)),(0===d?s>=u:n>=y)&&(h.push(f+1),h.push(p),h.push(1-d))}return a}within(t,r,s){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:n,coords:i,nodeSize:e}=this,o=[0,n.length-1,0],h=[],a=s*s;for(;o.length;){const p=o.pop()||0,c=o.pop()||0,f=o.pop()||0;if(c-f<=e){for(let s=f;s<=c;s++)d(i[2*s],i[2*s+1],t,r)<=a&&h.push(n[s]);continue}const u=f+c>>1,y=i[2*u],w=i[2*u+1];d(y,w,t,r)<=a&&h.push(n[u]),(0===p?t-s<=y:r-s<=w)&&(o.push(f),o.push(u-1),o.push(1-p)),(0===p?t+s>=y:r+s>=w)&&(o.push(u+1),o.push(c),o.push(1-p))}return h}}function e(t,r,s,n,i,h){if(i-n<=s)return;const a=n+i>>1;o(t,r,a,n,i,h),e(t,r,s,n,a-1,1-h),e(t,r,s,a+1,i,1-h)}function o(t,r,s,n,i,e){for(;i>n;){if(i-n>600){const h=i-n+1,a=s-n+1,d=Math.log(h),p=.5*Math.exp(2*d/3),c=.5*Math.sqrt(d*p*(h-p)/h)*(a-h/2<0?-1:1);o(t,r,s,Math.max(n,Math.floor(s-a*p/h+c)),Math.min(i,Math.floor(s+(h-a)*p/h+c)),e)}const a=r[2*s+e];let d=n,p=i;for(h(t,r,n,s),r[2*i+e]>a&&h(t,r,n,i);d<p;){for(h(t,r,d,p),d++,p--;r[2*d+e]<a;)d++;for(;r[2*p+e]>a;)p--}r[2*n+e]===a?h(t,r,n,p):(p++,h(t,r,p,i)),p<=s&&(n=p+1),s<=p&&(i=p-1)}}function h(t,r,s,n){a(t,s,n),a(r,2*s,2*n),a(r,2*s+1,2*n+1)}function a(t,r,s){const n=t[r];t[r]=t[s],t[s]=n}function d(t,r,s,n){const i=t-s,e=r-n;return i*i+e*e}}}]);